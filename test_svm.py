import numpy as np
from sklearn import svm

train_set = np.genfromtxt('data/train.csv', delimiter=',', skip_header=1)

y = train_set[:, 0].astype(int)
X = train_set[:, 1:]

clf = svm.SVC()
clf.fit(X, y)

test_set = np.genfromtxt('data/test.csv', delimiter=',', skip_header=1)
yt = test_set[:, 0].astype(int)
Xt = test_set[:, 1:]

ybar = clf.predict(X)
n = y.shape[0]

# naming format: truth_prediction
#
# 1: benware, i.e., benign/benevolent software
# 2: malware, i.e., malicious/malevolent software
ben_1 = np.sum(np.logical_and(y == 1, ybar == 1)) / n
ben_2 = np.sum(np.logical_and(y == 1, ybar == 2)) / n
mal_1 = np.sum(np.logical_and(y == 2, ybar == 1)) / n
mal_2 = np.sum(np.logical_and(y == 2, ybar == 2)) / n

with open('data/test_svm_result.csv', 'a') as w:
    w.write('{:.4f},{:.4f},{:.4f},{:.4f}\n'.format(
        ben_1, ben_2, mal_1, mal_2))
